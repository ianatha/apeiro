// a function that asks for a number and displays it
import { io } from "apeiro://$";

export default function sum_of_two_numbers() {
		const n = io.input({
			number1: io.number(),
			number2: io.number(),
		});

		return n.number1 + n.number2;
}

// a function that responds with a random quote everytime I message it
import { recvMessage, respondToMessage } from "apeiro://$/slack";

export default function main() {
	while (true) {
		const msg = recvMessage();
		const quoteResponse = fetchjson("https://zenquotes.io/api/random");
		const quote = quoteResponse[0].q;
		const author = quoteResponse[0].a;
		respondToMessage(msg, "You say " + msg.text + ", but " + author + " said " + quote);
	}
	return "Hello, world!";
}

// a function that emails me a random quote every morning
import { sendEmail } from "apeiro://$/emailbox";
import { time } from "apeiro://$/time";

export default function send_me_good_morning_every_morning() {
	let me = "you@example.com";
	while (true) {
		sendEmail(me, "Good Morning", "Just wanted to say good morning!);
		waitUntil(time.NextMorning());
	}
}

// To query Yahoo Finance for SYMB you must call https://query1.finance.yahoo.com/v7/finance/quote?symbols=SYMB
// let price = response.quoteResponse.result[0].regularMarketPrice

// a function that responds with a random quote when it gets an email
import { recvEmail, sendEmail } from "apeiro://$/emailbox"

export default function respond_to_email_with_quote() {
	while (true) {
		let new_email = recvEmail();

		let subject = new_email.commonHeaders.subject;
		let sender = new_email.commonHeaders.from[0];

		let quote = fetchjson("https://api.random_quote_api.com");
		
		sendEmail(
			sender,
			`+"`"+`Re: ${subject}`+"`"+`,
			quote.content
		);
	}
}
